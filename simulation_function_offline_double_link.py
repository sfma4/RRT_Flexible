import pybullet as p
from time import sleep
import time
import pybullet_data
import math
import matplotlib.pyplot as plt
import numpy as np
path = "C:\\Users\\Shang-G14\\EE_simulation\\bullet\\bullet3\\examples\\pybullet\\gym\\pybullet_data\\"
physicsClient = p.connect(p.GUI)
p.resetSimulation()
p.setRealTimeSimulation(0)

p.setAdditionalSearchPath(pybullet_data.getDataPath())
p.resetDebugVisualizerCamera(cameraDistance=12.5, cameraYaw=24.40, cameraPitch=-28,
                             cameraTargetPosition=[2.3, 2.0, 0.85])

# boxId = p.loadURDF(path+"TwoLink_Chain.urdf", basePosition=[2.75, 0, 2],
#                    baseOrientation=p.getQuaternionFromEuler([math.pi/2, math.pi/2, 0]), useFixedBase=False)
# boxId = p.loadURDF(path+"short_chain.urdf", basePosition=[2.75, 0, 2],
#                    baseOrientation=p.getQuaternionFromEuler([math.pi/2, math.pi/2, 0]), useFixedBase=False)

# box2 = p.loadURDF(path+"TwoLink_4.urdf", basePosition=[5.75, 0, 3],
#                    baseOrientation=p.getQuaternionFromEuler([math.pi/2, math.pi/2, 0]), useFixedBase=False)
boxId = p.loadURDF(path + "TwoLink_5.urdf", basePosition=[0, 0, 0],
                   baseOrientation=p.getQuaternionFromEuler([math.pi / 2, math.pi / 2, 0]), useFixedBase=False)
# boxId = p.loadURDF(path + "short_chain.urdf", basePosition=[0, 0, 0],
#                    baseOrientation=p.getQuaternionFromEuler([math.pi / 2, math.pi / 2, 0]), useFixedBase=False)

objId = p.loadURDF(path + "cube.urdf", basePosition=[7.5, 0, 2.5],
                   useFixedBase=True, globalScaling=5)
ob2 = p.loadURDF(path + "cube.urdf", basePosition=[8, 0, 5.5],
                 useFixedBase=True, globalScaling=1)
redSlider = p.addUserDebugParameter("red", 0, 1, 1)
greenSlider = p.addUserDebugParameter("green", 0, 1, 0)
blueSlider = p.addUserDebugParameter("blue", 0, 1, 0)
alphaSlider = p.addUserDebugParameter("alpha", 0, 1, 0.5)
red = p.readUserDebugParameter(redSlider)
green = p.readUserDebugParameter(greenSlider)
blue = p.readUserDebugParameter(blueSlider)
alpha = p.readUserDebugParameter(alphaSlider)
p.changeVisualShape(ob2, -1, rgbaColor=[red, green, blue, alpha])
p.changeDynamics(boxId, 4, lateralFriction=0.2)
# print('dynamics', p.getDynamicsInfo(boxId, 4))
p.changeDynamics(boxId, 3, linearDamping=1.0, angularDamping=1.0)
p.changeDynamics(boxId, 4, lateralFriction=0.25)
# p.changeDynamics(boxId, 6, lateralFriction=0.18)
# random_fric = np.random.uniform(0.1, 0.2)
p.changeDynamics(boxId, 6, lateralFriction=0.18)

target_v = 5.0  # motor angular speed rad/s and linear speed @@@@@@ how come this value change the position result?
# target_v = [target_v, target_v]
max_force = 800  # max force exerted by motor
x_plot, y_plot = [], []
force = []
joint1_pos = []
# p1 = np.array([[5.08098376, 6.2       ], [5.08314282, 6.19547741], [5.08530189, 6.19095481], [5.08746095, 6.18643222], [5.08962001, 6.18190963], [5.09177908, 6.17738703], [5.09393814, 6.17286444], [5.09609721, 6.16834185], [5.09825627, 6.16381925], [5.10041533, 6.15929666], [5.1025744 , 6.15477407], [5.10473346, 6.15025148], [5.10689252, 6.14572888], [5.10905159, 6.14120629], [5.11121065, 6.1366837 ], [5.11336971, 6.1321611 ], [5.11552878, 6.12763851], [5.11768784, 6.12311592], [5.11984691, 6.11859332], [5.12200597, 6.11407073], [5.12416503, 6.10954814], [5.1263241 , 6.10502554], [5.12848316, 6.10050295], [5.13064222, 6.09598036], [5.13280129, 6.09145776], [5.13496035, 6.08693517], [5.13711941, 6.08241258], [5.13927848, 6.07788998], [5.14143754, 6.07336739], [5.14359661, 6.0688448 ], [5.14575567, 6.06432221], [5.14791473, 6.05979961], [5.1500738 , 6.05527702], [5.15223286, 6.05075443], [5.15439192, 6.04623183], [5.15655099, 6.04170924], [5.15871005, 6.03718665], [5.16086911, 6.03266405], [5.16302818, 6.02814146], [5.16518724, 6.02361887], [5.1673463 , 6.01909627], [5.16950537, 6.01457368], [5.17166443, 6.01005109], [5.1738235 , 6.00552849], [5.17598256, 6.0010059 ], [5.17814162, 5.99648331], [5.18030069, 5.99196072], [5.18245975, 5.98743812], [5.18461881, 5.98291553], [5.18677788, 5.97839294], [5.18893694, 5.97387034], [5.191096  , 5.96934775], [5.19325507, 5.96482516], [5.19541413, 5.96030256], [5.1975732 , 5.95577997], [5.19973226, 5.95125738], [5.20189132, 5.94673478], [5.20405039, 5.94221219], [5.20620945, 5.9376896 ], [5.20836851, 5.933167  ], [5.21052758, 5.92864441], [5.21268664, 5.92412182], [5.2148457 , 5.91959922], [5.21700477, 5.91507663], [5.21916383, 5.91055404], [5.2213229 , 5.90603145], [5.22348196, 5.90150885], [5.22564102, 5.89698626], [5.22780009, 5.89246367], [5.22995915, 5.88794107], [5.23211821, 5.88341848], [5.23427728, 5.87889589], [5.23643634, 5.87437329], [5.2385954, 5.8698507], [5.24075447, 5.86532811], [5.24291353, 5.86080551], [5.2450726 , 5.85628292], [5.24723166, 5.85176033], [5.24939072, 5.84723773], [5.25154979, 5.84271514], [5.25370885, 5.83819255], [5.25586791, 5.83366995], [5.25802698, 5.82914736], [5.26018604, 5.82462477], [5.2623451 , 5.82010218], [5.26450417, 5.81557958], [5.26666323, 5.81105699], [5.2688223, 5.8065344], [5.27098136, 5.8020118 ], [5.27314042, 5.79748921], [5.27529949, 5.79296662], [5.27745855, 5.78844402], [5.27961761, 5.78392143], [5.28177668, 5.77939884], [5.28393574, 5.77487624], [5.2860948 , 5.77035365], [5.28825387, 5.76583106], [5.29041293, 5.76130846], [5.292572  , 5.75678587], [5.29473106, 5.75226328], [5.29689012, 5.74774069], [5.29904919, 5.74321809], [5.30120825, 5.7386955 ], [5.30336731, 5.73417291], [5.30552638, 5.72965031], [5.30768544, 5.72512772], [5.3098445 , 5.72060513], [5.31200357, 5.71608253], [5.31416263, 5.71155994], [5.3163217 , 5.70703735], [5.31848076, 5.70251475], [5.32063982, 5.69799216], [5.32279889, 5.69346957], [5.32495795, 5.68894697], [5.32711701, 5.68442438], [5.32927608, 5.67990179], [5.33143514, 5.67537919], [5.3335942, 5.6708566], [5.33575327, 5.66633401], [5.33791233, 5.66181142], [5.3400714 , 5.65728882], [5.34223046, 5.65276623], [5.34438952, 5.64824364], [5.34654859, 5.64372104], [5.34870765, 5.63919845], [5.35086671, 5.63467586], [5.35302578, 5.63015326], [5.35518484, 5.62563067], [5.3573439 , 5.62110808], [5.35950297, 5.61658548], [5.36166203, 5.61206289], [5.3638211, 5.6075403], [5.36598016, 5.6030177 ], [5.36813922, 5.59849511], [5.37029829, 5.59397252], [5.37245735, 5.58944992], [5.37461641, 5.58492733], [5.08098376, 6.2       ], [5.08518376, 6.1934273 ], [5.08938376, 6.1868546 ], [5.09358376, 6.1802819 ], [5.09778376, 6.1737092 ], [5.10198376, 6.1671365 ], [5.10618376, 6.16056381], [5.11038376, 6.15399111], [5.11458376, 6.14741841], [5.11878376, 6.14084571], [5.12298376, 6.13427301], [5.12718376, 6.12770031], [5.13138376, 6.12112761], [5.13558376, 6.11455491], [5.13978376, 6.10798221], [5.14398376, 6.10140951], [5.14818376, 6.09483681], [5.15238376, 6.08826412], [5.15658376, 6.08169142], [5.16078376, 6.07511872], [5.16498376, 6.06854602], [5.16918376, 6.06197332], [5.17338376, 6.05540062], [5.17758376, 6.04882792], [5.18178376, 6.04225522], [5.18598376, 6.03568252], [5.19018376, 6.02910982], [5.19438376, 6.02253713], [5.19858376, 6.01596443], [5.20278376, 6.00939173], [5.20698376, 6.00281903], [5.21118376, 5.99624633], [5.21538376, 5.98967363], [5.21958376, 5.98310093], [5.22378376, 5.97652823], [5.22798376, 5.96995553], [5.23218376, 5.96338283], [5.23638376, 5.95681013], [5.24058376, 5.95023744], [5.24478376, 5.94366474], [5.24898376, 5.93709204], [5.25318376, 5.93051934], [5.25738376, 5.92394664], [5.26158376, 5.91737394], [5.26578376, 5.91080124], [5.26998376, 5.90422854], [5.27418376, 5.89765584], [5.27838376, 5.89108314], [5.28258376, 5.88451044], [5.28678376, 5.87793775], [5.29098376, 5.87136505], [5.29518376, 5.86479235], [5.29938376, 5.85821965], [5.30358376, 5.85164695], [5.30778376, 5.84507425], [5.31198376, 5.83850155], [5.31618376, 5.83192885], [5.32038376, 5.82535615], [5.32458376, 5.81878345], [5.32878376, 5.81221075], [5.33298376, 5.80563806], [5.33718376, 5.79906536], [5.34138376, 5.79249266], [5.34558376, 5.78591996], [5.34978376, 5.77934726], [5.35398376, 5.77277456], [5.35818376, 5.76620186], [5.36238376, 5.75962916], [5.36658376, 5.75305646], [5.37078376, 5.74648376], [5.37498376, 5.73991106], [5.37918376, 5.73333837], [5.38338376, 5.72676567], [5.38758376, 5.72019297], [5.39178376, 5.71362027], [5.39598376, 5.70704757], [5.40018376, 5.70047487], [5.40438376, 5.69390217], [5.40858376, 5.68732947], [5.41278376, 5.68075677], [5.41698376, 5.67418407], [5.42118376, 5.66761138], [5.42538376, 5.66103868], [5.42958376, 5.65446598], [5.43378376, 5.64789328], [5.43798376, 5.64132058], [5.44218376, 5.63474788], [5.44638376, 5.62817518], [5.45058376, 5.62160248], [5.45478376, 5.61502978], [5.45898376, 5.60845708], [5.46318376, 5.60188438], [5.46738376, 5.59531169], [5.47158376, 5.58873899], [5.47578376, 5.58216629], [5.37593452, 5.58216629], [5.38013452, 5.5822229 ], [5.38433452, 5.58227952], [5.38853452, 5.58233613], [5.39273452, 5.58239275], [5.39693452, 5.58244936], [5.40113452, 5.58250598], [5.40533452, 5.58256259], [5.40953452, 5.58261921], [5.41373452, 5.58267582], [5.41793452, 5.58273244], [5.42213452, 5.58278905], [5.42633452, 5.58284567], [5.43053452, 5.58290228], [5.43473452, 5.5829589 ], [5.43893452, 5.58301551], [5.44313452, 5.58307213], [5.44733452, 5.58312874], [5.45153452, 5.58318536], [5.45573452, 5.58324197], [5.45993452, 5.58329859], [5.46413452, 5.5833552 ], [5.46833452, 5.58341182], [5.47253452, 5.58346843], [5.47673452, 5.58352505], [5.48093452, 5.58358166], [5.48513452, 5.58363828], [5.48933452, 5.58369489], [5.49353452, 5.58375151], [5.49773452, 5.58380812], [5.50193452, 5.58386474], [5.50613452, 5.58392135], [5.51033452, 5.58397797], [5.51453452, 5.58403458], [5.51873452, 5.5840912 ], [5.52293452, 5.58414781], [5.52713452, 5.58420443], [5.53133452, 5.58426104], [5.53553452, 5.58431766], [5.53973452, 5.58437427], [5.54393452, 5.58443089], [5.54813452, 5.5844875 ], [5.55233452, 5.58454412], [5.55653452, 5.58460073], [5.56073452, 5.58465735], [5.56493452, 5.58471396], [5.56913452, 5.58477058], [5.57333452, 5.58482719], [5.57753452, 5.58488381], [5.58173452, 5.58494042], [5.58593452, 5.58499704], [5.59013452, 5.58505365], [5.59433452, 5.58511027], [5.59853452, 5.58516688], [5.60273452, 5.5852235 ], [5.60693452, 5.58528011], [5.61113452, 5.58533672], [5.61533452, 5.58539334], [5.61953452, 5.58544995], [5.62373452, 5.58550657], [5.62793452, 5.58556318], [5.63213452, 5.5856198 ], [5.63633452, 5.58567641], [5.64053452, 5.58573303], [5.64473452, 5.58578964], [5.64893452, 5.58584626], [5.65313452, 5.58590287], [5.65733452, 5.58595949], [5.66153452, 5.5860161 ], [5.66573452, 5.58607272], [5.66993452, 5.58612933], [5.67413452, 5.58618595], [5.67833452, 5.58624256], [5.68253452, 5.58629918], [5.68673452, 5.58635579], [5.69093452, 5.58641241], [5.69513452, 5.58646902], [5.69933452, 5.58652564], [5.70353452, 5.58658225], [5.70773452, 5.58663887], [5.71193452, 5.58669548], [5.71613452, 5.5867521 ], [5.72033452, 5.58680871], [5.72453452, 5.58686533], [5.72873452, 5.58692194], [5.73293452, 5.58697856], [5.73713452, 5.58703517], [5.74133452, 5.58709179], [5.74553452, 5.5871484 ], [5.74973452, 5.58720502], [5.75393452, 5.58726163], [5.75813452, 5.58731825], [5.76233452, 5.58737486], [5.76653452, 5.58743148], [5.77073452, 5.58748809], [5.77493452, 5.58754471], [5.77913452, 5.58760132], [5.78333452, 5.58765794], [5.78753452, 5.58771455], [5.79173452, 5.58777117], [5.79593452, 5.58782778], [5.80013452, 5.5878844 ], [5.80433452, 5.58794101], [5.80853452, 5.58799763], [5.81273452, 5.58805424], [5.81693452, 5.58811086], [5.82113452, 5.58816747], [5.82533452, 5.58822409], [5.82953452, 5.5882807 ], [5.83373452, 5.58833732], [5.83793452, 5.58839393], [5.84213452, 5.58845055], [5.84633452, 5.58850716], [5.85053452, 5.58856378], [5.85473452, 5.58862039], [5.85893452, 5.58867701], [5.86313452, 5.58873362], [5.86733452, 5.58879024], [5.87153452, 5.58884685], [5.87573452, 5.58890347], [5.87993452, 5.58896008], [5.88413452, 5.5890167 ], [5.88833452, 5.58907331], [5.89253452, 5.58912993], [5.89673452, 5.58918654], [5.90093452, 5.58924316], [5.90513452, 5.58929977], [5.90933452, 5.58935639], [5.91353452, 5.589413  ], [5.91773452, 5.58946962], [5.92193452, 5.58952623], [5.92613452, 5.58958285], [5.93033452, 5.58963946], [5.93453452, 5.58969608], [5.93873452, 5.58975269], [5.94293452, 5.58980931], [5.94713452, 5.58986592], [5.95133452, 5.58992254], [5.95553452, 5.58997915], [5.95973452, 5.59003577], [5.96393452, 5.59009238], [5.96813452, 5.590149  ], [5.97233452, 5.59020561], [5.97653452, 5.59026223], [5.98073452, 5.59031884], [5.98493452, 5.59037546], [5.98913452, 5.59043207], [5.99333452, 5.59048869], [5.99753452, 5.5905453 ], [6.00173452, 5.59060192], [6.00593452, 5.59065853], [6.01013452, 5.59071515], [6.01433452, 5.59077176], [6.01853452, 5.59082838], [6.02273452, 5.59088499], [6.02693452, 5.59094161], [6.03113452, 5.59099822], [6.03533452, 5.59105484], [6.03953452, 5.59111145], [6.04373452, 5.59116807], [6.04793452, 5.59122468], [6.05213452, 5.5912813 ], [6.05633452, 5.59133791], [6.06053452, 5.59139453], [6.06473452, 5.59145114], [6.06893452, 5.59150776], [6.07313452, 5.59156437], [6.07733452, 5.59162099], [6.08153452, 5.5916776 ], [6.08573452, 5.59173422], [6.08993452, 5.59179083], [6.09413452, 5.59184745], [6.09833452, 5.59190406], [6.10253452, 5.59196068], [6.10673452, 5.59201729], [6.11093452, 5.59207391], [6.11513452, 5.59213052], [6.11933452, 5.59218714], [6.12353452, 5.59224375], [6.12773452, 5.59230037], [6.13193452, 5.59235698], [6.13613452, 5.5924136 ], [6.14033452, 5.59247021], [6.14453452, 5.59252683], [6.14873452, 5.59258344], [6.15293452, 5.59264005], [6.15713452, 5.59269667], [6.16133452, 5.59275328], [6.16553452, 5.5928099 ], [6.16973452, 5.59286651], [6.17393452, 5.59292313], [6.17813452, 5.59297974], [6.18233452, 5.59303636], [6.18653452, 5.59309297], [6.19073452, 5.59314959], [6.19493452, 5.5932062 ], [6.19913452, 5.59326282], [6.20333452, 5.59331943], [6.20753452, 5.59337605], [6.21173452, 5.59343266], [6.21593452, 5.59348928], [6.22013452, 5.59354589], [6.22433452, 5.59360251], [6.22853452, 5.59365912], [6.23273452, 5.59371574], [6.23693452, 5.59377235], [6.24113452, 5.59382897], [6.24533452, 5.59388558], [6.24953452, 5.5939422 ], [6.25373452, 5.59399881], [6.25793452, 5.59405543], [6.26213452, 5.59411204], [6.26633452, 5.59416866], [6.27053452, 5.59422527], [6.27473452, 5.59428189], [6.27893452, 5.5943385 ], [6.28313452, 5.59439512], [6.28733452, 5.59445173], [6.29153452, 5.59450835], [6.29573452, 5.59456496], [6.29993452, 5.59462158], [6.30413452, 5.59467819], [6.30833452, 5.59473481], [6.31253452, 5.59479142], [6.31673452, 5.59484804], [6.32093452, 5.59490465], [6.32513452, 5.59496127], [6.32933452, 5.59501788], [6.33353452, 5.5950745 ], [6.33773452, 5.59513111], [6.34193452, 5.59518773], [6.34613452, 5.59524434], [6.35033452, 5.59530096], [6.35453452, 5.59535757], [6.35873452, 5.59541419], [6.36293452, 5.5954708 ], [6.36713452, 5.59552742], [6.37133452, 5.59558403], [6.37553452, 5.59564065], [6.37973452, 5.59569726], [6.38393452, 5.59575388], [6.38813452, 5.59581049], [6.39233452, 5.59586711], [6.39653452, 5.59592372], [6.40073452, 5.59598034], [6.40493452, 5.59603695], [6.40913452, 5.59609357], [6.41333452, 5.59615018], [6.41753452, 5.5962068 ], [6.42173452, 5.59626341], [6.42593452, 5.59632003], [6.43013452, 5.59637664], [6.43433452, 5.59643326], [6.43853452, 5.59648987], [6.44273452, 5.59654649], [6.44693452, 5.5966031 ], [6.45113452, 5.59665972], [6.45533452, 5.59671633], [6.45953452, 5.59677295], [6.46373452, 5.59682956], [6.46793452, 5.59688618], [6.47213452, 5.59694279], [6.47633452, 5.59699941], [6.48053452, 5.59705602], [6.48473452, 5.59711264], [6.48893452, 5.59716925], [6.49313452, 5.59722587], [6.49733452, 5.59728248], [6.50153452, 5.5973391 ], [6.50573452, 5.59739571], [6.50993452, 5.59745233], [6.51413452, 5.59750894], [6.51833452, 5.59756556], [6.52253452, 5.59762217], [6.52673452, 5.59767879], [6.53093452, 5.5977354 ], [6.53513452, 5.59779202], [6.53933452, 5.59784863], [6.54353452, 5.59790525], [6.54773452, 5.59796186], [6.55193452, 5.59801848], [6.55613452, 5.59807509], [6.56033452, 5.59813171], [6.56453452, 5.59818832], [6.56873452, 5.59824494], [6.57293452, 5.59830155], [6.57713452, 5.59835817], [6.58133452, 5.59841478], [6.58553452, 5.5984714 ], [6.58973452, 5.59852801], [6.59393452, 5.59858463], [6.59813452, 5.59864124], [6.60233452, 5.59869786], [6.60653452, 5.59875447], [6.61073452, 5.59881109], [6.61493452, 5.5988677 ], [6.61913452, 5.59892432], [6.62333452, 5.59898093], [6.62753452, 5.59903755], [6.63173452, 5.59909416], [6.63593452, 5.59915078], [6.64013452, 5.59920739], [6.64433452, 5.59926401], [6.64853452, 5.59932062], [6.65273452, 5.59937724], [6.65693452, 5.59943385], [6.66113452, 5.59949047], [6.66533452, 5.59954708], [6.66953452, 5.5996037 ], [6.67373452, 5.59966031], [6.67793452, 5.59971693], [6.68213452, 5.59977354], [6.68633452, 5.59983016], [6.69053452, 5.59988677], [6.69473452, 5.59994339], [6.69893452, 5.6       ]])
# p1 = np.array([[5.08098376, 6.2       ], [5.08518376, 6.1934273 ], [5.08938376, 6.1868546 ], [5.09358376, 6.1802819 ], [5.09778376, 6.1737092 ], [5.10198376, 6.1671365 ], [5.10618376, 6.16056381], [5.11038376, 6.15399111], [5.11458376, 6.14741841], [5.11878376, 6.14084571], [5.12298376, 6.13427301], [5.12718376, 6.12770031], [5.13138376, 6.12112761], [5.13558376, 6.11455491], [5.13978376, 6.10798221], [5.14398376, 6.10140951], [5.14818376, 6.09483681], [5.15238376, 6.08826412], [5.15658376, 6.08169142], [5.16078376, 6.07511872], [5.16498376, 6.06854602], [5.16918376, 6.06197332], [5.17338376, 6.05540062], [5.17758376, 6.04882792], [5.18178376, 6.04225522], [5.18598376, 6.03568252], [5.19018376, 6.02910982], [5.19438376, 6.02253713], [5.19858376, 6.01596443], [5.20278376, 6.00939173], [5.20698376, 6.00281903], [5.21118376, 5.99624633], [5.21538376, 5.98967363], [5.21958376, 5.98310093], [5.22378376, 5.97652823], [5.22798376, 5.96995553], [5.23218376, 5.96338283], [5.23638376, 5.95681013], [5.24058376, 5.95023744], [5.24478376, 5.94366474], [5.24898376, 5.93709204], [5.25318376, 5.93051934], [5.25738376, 5.92394664], [5.26158376, 5.91737394], [5.26578376, 5.91080124], [5.26998376, 5.90422854], [5.27418376, 5.89765584], [5.27838376, 5.89108314], [5.28258376, 5.88451044], [5.28678376, 5.87793775], [5.29098376, 5.87136505], [5.29518376, 5.86479235], [5.29938376, 5.85821965], [5.30358376, 5.85164695], [5.30778376, 5.84507425], [5.31198376, 5.83850155], [5.31618376, 5.83192885], [5.32038376, 5.82535615], [5.32458376, 5.81878345], [5.32878376, 5.81221075], [5.33298376, 5.80563806], [5.33718376, 5.79906536], [5.34138376, 5.79249266], [5.34558376, 5.78591996], [5.34978376, 5.77934726], [5.35398376, 5.77277456], [5.35818376, 5.76620186], [5.36238376, 5.75962916], [5.36658376, 5.75305646], [5.37078376, 5.74648376], [5.37498376, 5.73991106], [5.37918376, 5.73333837], [5.38338376, 5.72676567], [5.38758376, 5.72019297], [5.39178376, 5.71362027], [5.39598376, 5.70704757], [5.40018376, 5.70047487], [5.40438376, 5.69390217], [5.40858376, 5.68732947], [5.41278376, 5.68075677], [5.41698376, 5.67418407], [5.42118376, 5.66761138], [5.42538376, 5.66103868], [5.42958376, 5.65446598], [5.43378376, 5.64789328], [5.43798376, 5.64132058], [5.44218376, 5.63474788], [5.44638376, 5.62817518], [5.45058376, 5.62160248], [5.45478376, 5.61502978], [5.45898376, 5.60845708], [5.46318376, 5.60188438], [5.46738376, 5.59531169], [5.47158376, 5.58873899], [5.47578376, 5.58216629], [5.37593452, 5.58216629], [5.38013452, 5.5822229 ], [5.38433452, 5.58227952], [5.38853452, 5.58233613], [5.39273452, 5.58239275], [5.39693452, 5.58244936], [5.40113452, 5.58250598], [5.40533452, 5.58256259], [5.40953452, 5.58261921], [5.41373452, 5.58267582], [5.41793452, 5.58273244], [5.42213452, 5.58278905], [5.42633452, 5.58284567], [5.43053452, 5.58290228], [5.43473452, 5.5829589 ], [5.43893452, 5.58301551], [5.44313452, 5.58307213], [5.44733452, 5.58312874], [5.45153452, 5.58318536], [5.45573452, 5.58324197], [5.45993452, 5.58329859], [5.46413452, 5.5833552 ], [5.46833452, 5.58341182], [5.47253452, 5.58346843], [5.47673452, 5.58352505], [5.48093452, 5.58358166], [5.48513452, 5.58363828], [5.48933452, 5.58369489], [5.49353452, 5.58375151], [5.49773452, 5.58380812], [5.50193452, 5.58386474], [5.50613452, 5.58392135], [5.51033452, 5.58397797], [5.51453452, 5.58403458], [5.51873452, 5.5840912 ], [5.52293452, 5.58414781], [5.52713452, 5.58420443], [5.53133452, 5.58426104], [5.53553452, 5.58431766], [5.53973452, 5.58437427], [5.54393452, 5.58443089], [5.54813452, 5.5844875 ], [5.55233452, 5.58454412], [5.55653452, 5.58460073], [5.56073452, 5.58465735], [5.56493452, 5.58471396], [5.56913452, 5.58477058], [5.57333452, 5.58482719], [5.57753452, 5.58488381], [5.58173452, 5.58494042], [5.58593452, 5.58499704], [5.59013452, 5.58505365], [5.59433452, 5.58511027], [5.59853452, 5.58516688], [5.60273452, 5.5852235 ], [5.60693452, 5.58528011], [5.61113452, 5.58533672], [5.61533452, 5.58539334], [5.61953452, 5.58544995], [5.62373452, 5.58550657], [5.62793452, 5.58556318], [5.63213452, 5.5856198 ], [5.63633452, 5.58567641], [5.64053452, 5.58573303], [5.64473452, 5.58578964], [5.64893452, 5.58584626], [5.65313452, 5.58590287], [5.65733452, 5.58595949], [5.66153452, 5.5860161 ], [5.66573452, 5.58607272], [5.66993452, 5.58612933], [5.67413452, 5.58618595], [5.67833452, 5.58624256], [5.68253452, 5.58629918], [5.68673452, 5.58635579], [5.69093452, 5.58641241], [5.69513452, 5.58646902], [5.69933452, 5.58652564], [5.70353452, 5.58658225], [5.70773452, 5.58663887], [5.71193452, 5.58669548], [5.71613452, 5.5867521 ], [5.72033452, 5.58680871], [5.72453452, 5.58686533], [5.72873452, 5.58692194], [5.73293452, 5.58697856], [5.73713452, 5.58703517], [5.74133452, 5.58709179], [5.74553452, 5.5871484 ], [5.74973452, 5.58720502], [5.75393452, 5.58726163], [5.75813452, 5.58731825], [5.76233452, 5.58737486], [5.76653452, 5.58743148], [5.77073452, 5.58748809], [5.77493452, 5.58754471], [5.77913452, 5.58760132], [5.78333452, 5.58765794], [5.78753452, 5.58771455], [5.79173452, 5.58777117], [5.79593452, 5.58782778], [5.80013452, 5.5878844 ], [5.80433452, 5.58794101], [5.80853452, 5.58799763], [5.81273452, 5.58805424], [5.81693452, 5.58811086], [5.82113452, 5.58816747], [5.82533452, 5.58822409], [5.82953452, 5.5882807 ], [5.83373452, 5.58833732], [5.83793452, 5.58839393], [5.84213452, 5.58845055], [5.84633452, 5.58850716], [5.85053452, 5.58856378], [5.85473452, 5.58862039], [5.85893452, 5.58867701], [5.86313452, 5.58873362], [5.86733452, 5.58879024], [5.87153452, 5.58884685], [5.87573452, 5.58890347], [5.87993452, 5.58896008], [5.88413452, 5.5890167 ], [5.88833452, 5.58907331], [5.89253452, 5.58912993], [5.89673452, 5.58918654], [5.90093452, 5.58924316], [5.90513452, 5.58929977], [5.90933452, 5.58935639], [5.91353452, 5.589413  ], [5.91773452, 5.58946962], [5.92193452, 5.58952623], [5.92613452, 5.58958285], [5.93033452, 5.58963946], [5.93453452, 5.58969608], [5.93873452, 5.58975269], [5.94293452, 5.58980931], [5.94713452, 5.58986592], [5.95133452, 5.58992254], [5.95553452, 5.58997915], [5.95973452, 5.59003577], [5.96393452, 5.59009238], [5.96813452, 5.590149  ], [5.97233452, 5.59020561], [5.97653452, 5.59026223], [5.98073452, 5.59031884], [5.98493452, 5.59037546], [5.98913452, 5.59043207], [5.99333452, 5.59048869], [5.99753452, 5.5905453 ], [6.00173452, 5.59060192], [6.00593452, 5.59065853], [6.01013452, 5.59071515], [6.01433452, 5.59077176], [6.01853452, 5.59082838], [6.02273452, 5.59088499], [6.02693452, 5.59094161], [6.03113452, 5.59099822], [6.03533452, 5.59105484], [6.03953452, 5.59111145], [6.04373452, 5.59116807], [6.04793452, 5.59122468], [6.05213452, 5.5912813 ], [6.05633452, 5.59133791], [6.06053452, 5.59139453], [6.06473452, 5.59145114], [6.06893452, 5.59150776], [6.07313452, 5.59156437], [6.07733452, 5.59162099], [6.08153452, 5.5916776 ], [6.08573452, 5.59173422], [6.08993452, 5.59179083], [6.09413452, 5.59184745], [6.09833452, 5.59190406], [6.10253452, 5.59196068], [6.10673452, 5.59201729], [6.11093452, 5.59207391], [6.11513452, 5.59213052], [6.11933452, 5.59218714], [6.12353452, 5.59224375], [6.12773452, 5.59230037], [6.13193452, 5.59235698], [6.13613452, 5.5924136 ], [6.14033452, 5.59247021], [6.14453452, 5.59252683], [6.14873452, 5.59258344], [6.15293452, 5.59264005], [6.15713452, 5.59269667], [6.16133452, 5.59275328], [6.16553452, 5.5928099 ], [6.16973452, 5.59286651], [6.17393452, 5.59292313], [6.17813452, 5.59297974], [6.18233452, 5.59303636], [6.18653452, 5.59309297], [6.19073452, 5.59314959], [6.19493452, 5.5932062 ], [6.19913452, 5.59326282], [6.20333452, 5.59331943], [6.20753452, 5.59337605], [6.21173452, 5.59343266], [6.21593452, 5.59348928], [6.22013452, 5.59354589], [6.22433452, 5.59360251], [6.22853452, 5.59365912], [6.23273452, 5.59371574], [6.23693452, 5.59377235], [6.24113452, 5.59382897], [6.24533452, 5.59388558], [6.24953452, 5.5939422 ], [6.25373452, 5.59399881], [6.25793452, 5.59405543], [6.26213452, 5.59411204], [6.26633452, 5.59416866], [6.27053452, 5.59422527], [6.27473452, 5.59428189], [6.27893452, 5.5943385 ], [6.28313452, 5.59439512], [6.28733452, 5.59445173], [6.29153452, 5.59450835], [6.29573452, 5.59456496], [6.29993452, 5.59462158], [6.30413452, 5.59467819], [6.30833452, 5.59473481], [6.31253452, 5.59479142], [6.31673452, 5.59484804], [6.32093452, 5.59490465], [6.32513452, 5.59496127], [6.32933452, 5.59501788], [6.33353452, 5.5950745 ], [6.33773452, 5.59513111], [6.34193452, 5.59518773], [6.34613452, 5.59524434], [6.35033452, 5.59530096], [6.35453452, 5.59535757], [6.35873452, 5.59541419], [6.36293452, 5.5954708 ], [6.36713452, 5.59552742], [6.37133452, 5.59558403], [6.37553452, 5.59564065], [6.37973452, 5.59569726], [6.38393452, 5.59575388], [6.38813452, 5.59581049], [6.39233452, 5.59586711], [6.39653452, 5.59592372], [6.40073452, 5.59598034], [6.40493452, 5.59603695], [6.40913452, 5.59609357], [6.41333452, 5.59615018], [6.41753452, 5.5962068 ], [6.42173452, 5.59626341], [6.42593452, 5.59632003], [6.43013452, 5.59637664], [6.43433452, 5.59643326], [6.43853452, 5.59648987], [6.44273452, 5.59654649], [6.44693452, 5.5966031 ], [6.45113452, 5.59665972], [6.45533452, 5.59671633], [6.45953452, 5.59677295], [6.46373452, 5.59682956], [6.46793452, 5.59688618], [6.47213452, 5.59694279], [6.47633452, 5.59699941], [6.48053452, 5.59705602], [6.48473452, 5.59711264], [6.48893452, 5.59716925], [6.49313452, 5.59722587], [6.49733452, 5.59728248], [6.50153452, 5.5973391 ], [6.50573452, 5.59739571], [6.50993452, 5.59745233], [6.51413452, 5.59750894], [6.51833452, 5.59756556], [6.52253452, 5.59762217], [6.52673452, 5.59767879], [6.53093452, 5.5977354 ], [6.53513452, 5.59779202], [6.53933452, 5.59784863], [6.54353452, 5.59790525], [6.54773452, 5.59796186], [6.55193452, 5.59801848], [6.55613452, 5.59807509], [6.56033452, 5.59813171], [6.56453452, 5.59818832], [6.56873452, 5.59824494], [6.57293452, 5.59830155], [6.57713452, 5.59835817], [6.58133452, 5.59841478], [6.58553452, 5.5984714 ], [6.58973452, 5.59852801], [6.59393452, 5.59858463], [6.59813452, 5.59864124], [6.60233452, 5.59869786], [6.60653452, 5.59875447], [6.61073452, 5.59881109], [6.61493452, 5.5988677 ], [6.61913452, 5.59892432], [6.62333452, 5.59898093], [6.62753452, 5.59903755], [6.63173452, 5.59909416], [6.63593452, 5.59915078], [6.64013452, 5.59920739], [6.64433452, 5.59926401], [6.64853452, 5.59932062], [6.65273452, 5.59937724], [6.65693452, 5.59943385], [6.66113452, 5.59949047], [6.66533452, 5.59954708], [6.66953452, 5.5996037 ], [6.67373452, 5.59966031], [6.67793452, 5.59971693], [6.68213452, 5.59977354], [6.68633452, 5.59983016], [6.69053452, 5.59988677], [6.69473452, 5.59994339], [6.69893452, 5.6       ]])
p1 = np.array([[5.09917118, 6.2       ],[5.09934851, 6.19519992],[5.09952584, 6.19039983],[5.09970317, 6.18559975],[5.0998805 , 6.18079966],[5.10005783, 6.17599958],[5.10023516, 6.1711995 ],[5.10041249, 6.16639941],[5.10058982, 6.16159933],[5.10076715, 6.15679924],[5.10094448, 6.15199916],[5.10112181, 6.14719908],[5.10129914, 6.14239899],[5.10147647, 6.13759891],[5.1016538 , 6.13279883],[5.10183113, 6.12799874],[5.10200846, 6.12319866],[5.10218579, 6.11839857],[5.10236312, 6.11359849],[5.10254045, 6.10879841],[5.10271778, 6.10399832],[5.10289511, 6.09919824],[5.10307244, 6.09439815],[5.10324977, 6.08959807],[5.1034271 , 6.08479799],[5.10360443, 6.0799979 ],[5.10378176, 6.07519782],[5.10395909, 6.07039773],[5.10413642, 6.06559765],[5.10431376, 6.06079757],[5.10449109, 6.05599748],[5.10466842, 6.0511974 ],[5.10484575, 6.04639731],[5.10502308, 6.04159723],[5.10520041, 6.03679715],[5.10537774, 6.03199706],[5.10555507, 6.02719698],[5.1057324, 6.0223969],[5.10590973, 6.01759681],[5.10608706, 6.01279673],[5.10626439, 6.00799664],[5.10644172, 6.00319656],[5.10661905, 5.99839648],[5.10679638, 5.99359639],[5.10697371, 5.98879631],[5.10715104, 5.98399622],[5.10732837, 5.97919614],[5.1075057 , 5.97439606],[5.10768303, 5.96959597],[5.10786036, 5.96479589],[5.10803769, 5.9599958 ],[5.10821502, 5.95519572],[5.10839235, 5.95039564],[5.10856968, 5.94559555],[5.10874701, 5.94079547],[5.10892434, 5.93599538],[5.10910167, 5.9311953 ],[5.109279  , 5.92639522],[5.10945633, 5.92159513],[5.10963366, 5.91679505],[5.10981099, 5.91199497],[5.10998832, 5.90719488],[5.11016565, 5.9023948 ],[5.11034298, 5.89759471],[5.11052032, 5.89279463],[5.11069765, 5.88799455],[5.11087498, 5.88319446],[5.11105231, 5.87839438],[5.11122964, 5.87359429],[5.11140697, 5.86879421],[5.1115843 , 5.86399413],[5.11176163, 5.85919404],[5.11193896, 5.85439396],[5.11211629, 5.84959387],[5.11229362, 5.84479379],[5.11247095, 5.83999371],[5.11264828, 5.83519362],[5.11282561, 5.83039354],[5.11300294, 5.82559345],[5.11318027, 5.82079337],[5.1133576 , 5.81599329],[5.11353493, 5.8111932 ],[5.11371226, 5.80639312],[5.11388959, 5.80159304],[5.11406692, 5.79679295],[5.11424425, 5.79199287],[5.11442158, 5.78719278],[5.11459891, 5.7823927 ],[5.11477624, 5.77759262],[5.11495357, 5.77279253],[5.1151309 , 5.76799245],[5.11530823, 5.76319236],[5.11548556, 5.75839228],[5.11566289, 5.7535922 ],[5.11584022, 5.74879211],[5.11601755, 5.74399203],[5.11619488, 5.73919194],[5.11637221, 5.73439186],[5.11654954, 5.72959178],[5.11672688, 5.72479169],[5.11690421, 5.71999161],[5.11708154, 5.71519153],[5.11725887, 5.71039144],[5.1174362 , 5.70559136],[5.11761353, 5.70079127],[5.11779086, 5.69599119],[5.11796819, 5.69119111],[5.11814552, 5.68639102],[5.11832285, 5.68159094],[5.11850018, 5.67679085],[5.11867751, 5.67199077],[5.11885484, 5.66719069],[5.11903217, 5.6623906 ],[5.1192095 , 5.65759052],[5.11938683, 5.65279043],[5.09917118, 6.2       ],[5.10337118, 6.06234832],[5.10757118, 5.92469664],[5.11177118, 5.78704496],[5.11597118, 5.64939328],[5.11951233, 5.64939328],[5.12371233, 5.64925296],[5.12791233, 5.64911264],[5.13211233, 5.64897232],[5.13631233, 5.648832  ],[5.14051233, 5.64869167],[5.14471233, 5.64855135],[5.14891233, 5.64841103],[5.15311233, 5.64827071],[5.15731233, 5.64813039],[5.16151233, 5.64799007],[5.16571233, 5.64784974],[5.16991233, 5.64770942],[5.17411233, 5.6475691 ],[5.17831233, 5.64742878],[5.18251233, 5.64728846],[5.18671233, 5.64714813],[5.19091233, 5.64700781],[5.19511233, 5.64686749],[5.19931233, 5.64672717],[5.20351233, 5.64658685],[5.20771233, 5.64644653],[5.21191233, 5.6463062 ],[5.21611233, 5.64616588],[5.22031233, 5.64602556],[5.22451233, 5.64588524],[5.22871233, 5.64574492],[5.23291233, 5.64560459],[5.23711233, 5.64546427],[5.24131233, 5.64532395],[5.24551233, 5.64518363],[5.24971233, 5.64504331],[5.25391233, 5.64490299],[5.25811233, 5.64476266],[5.26231233, 5.64462234],[5.26651233, 5.64448202],[5.27071233, 5.6443417 ],[5.27491233, 5.64420138],[5.27911233, 5.64406105],[5.28331233, 5.64392073],[5.28751233, 5.64378041],[5.29171233, 5.64364009],[5.29591233, 5.64349977],[5.30011233, 5.64335945],[5.30431233, 5.64321912],[5.30851233, 5.6430788 ],[5.31271233, 5.64293848],[5.31691233, 5.64279816],[5.32111233, 5.64265784],[5.32531233, 5.64251751],[5.32951233, 5.64237719],[5.33371233, 5.64223687],[5.33791233, 5.64209655],[5.34211233, 5.64195623],[5.34631233, 5.64181591],[5.35051233, 5.64167558],[5.35471233, 5.64153526],[5.35891233, 5.64139494],[5.36311233, 5.64125462],[5.36731233, 5.6411143 ],[5.37151233, 5.64097397],[5.37571233, 5.64083365],[5.37991233, 5.64069333],[5.38411233, 5.64055301],[5.38831233, 5.64041269],[5.39251233, 5.64027237],[5.39671233, 5.64013204],[5.40091233, 5.63999172],[5.40511233, 5.6398514 ],[5.40931233, 5.63971108],[5.41351233, 5.63957076],[5.41771233, 5.63943043],[5.42191233, 5.63929011],[5.42611233, 5.63914979],[5.43031233, 5.63900947],[5.43451233, 5.63886915],[5.43871233, 5.63872882],[5.44291233, 5.6385885 ],[5.44711233, 5.63844818],[5.45131233, 5.63830786],[5.45551233, 5.63816754],[5.45971233, 5.63802722],[5.46391233, 5.63788689],[5.46811233, 5.63774657],[5.47231233, 5.63760625],[5.47651233, 5.63746593],[5.48071233, 5.63732561],[5.48491233, 5.63718528],[5.48911233, 5.63704496],[5.49331233, 5.63690464],[5.49751233, 5.63676432],[5.50171233, 5.636624  ],[5.50591233, 5.63648368],[5.51011233, 5.63634335],[5.51431233, 5.63620303],[5.51851233, 5.63606271],[5.52271233, 5.63592239],[5.52691233, 5.63578207],[5.53111233, 5.63564174],[5.53531233, 5.63550142],[5.53951233, 5.6353611 ],[5.54371233, 5.63522078],[5.54791233, 5.63508046],[5.55211233, 5.63494014],[5.55631233, 5.63479981],[5.56051233, 5.63465949],[5.56471233, 5.63451917],[5.56891233, 5.63437885],[5.57311233, 5.63423853],[5.57731233, 5.6340982 ],[5.58151233, 5.63395788],[5.58571233, 5.63381756],[5.58991233, 5.63367724],[5.59411233, 5.63353692],[5.59831233, 5.6333966 ],[5.60251233, 5.63325627],[5.60671233, 5.63311595],[5.61091233, 5.63297563],[5.61511233, 5.63283531],[5.61931233, 5.63269499],[5.62351233, 5.63255466],[5.62771233, 5.63241434],[5.63191233, 5.63227402],[5.63611233, 5.6321337 ],[5.64031233, 5.63199338],[5.64451233, 5.63185306],[5.64871233, 5.63171273],[5.65291233, 5.63157241],[5.65711233, 5.63143209],[5.66131233, 5.63129177],[5.66551233, 5.63115145],[5.66971233, 5.63101112],[5.67391233, 5.6308708 ],[5.67811233, 5.63073048],[5.68231233, 5.63059016],[5.68651233, 5.63044984],[5.69071233, 5.63030952],[5.69491233, 5.63016919],[5.69911233, 5.63002887],[5.70331233, 5.62988855],[5.70751233, 5.62974823],[5.71171233, 5.62960791],[5.71591233, 5.62946758],[5.72011233, 5.62932726],[5.72431233, 5.62918694],[5.72851233, 5.62904662],[5.73271233, 5.6289063 ],[5.73691233, 5.62876598],[5.74111233, 5.62862565],[5.74531233, 5.62848533],[5.74951233, 5.62834501],[5.75371233, 5.62820469],[5.75791233, 5.62806437],[5.76211233, 5.62792404],[5.76631233, 5.62778372],[5.77051233, 5.6276434 ],[5.77471233, 5.62750308],[5.77891233, 5.62736276],[5.78311233, 5.62722243],[5.78731233, 5.62708211],[5.79151233, 5.62694179],[5.79571233, 5.62680147],[5.79991233, 5.62666115],[5.80411233, 5.62652083],[5.80831233, 5.6263805 ],[5.81251233, 5.62624018],[5.81671233, 5.62609986],[5.82091233, 5.62595954],[5.82511233, 5.62581922],[5.82931233, 5.62567889],[5.83351233, 5.62553857],[5.83771233, 5.62539825],[5.84191233, 5.62525793],[5.84611233, 5.62511761],[5.85031233, 5.62497729],[5.85451233, 5.62483696],[5.85871233, 5.62469664],[5.86291233, 5.62455632],[5.86711233, 5.624416  ],[5.87131233, 5.62427568],[5.87551233, 5.62413535],[5.87971233, 5.62399503],[5.88391233, 5.62385471],[5.88811233, 5.62371439],[5.89231233, 5.62357407],[5.89651233, 5.62343375],[5.90071233, 5.62329342],[5.90491233, 5.6231531 ],[5.90911233, 5.62301278],[5.91331233, 5.62287246],[5.91751233, 5.62273214],[5.92171233, 5.62259181],[5.92591233, 5.62245149],[5.93011233, 5.62231117],[5.93431233, 5.62217085],[5.93851233, 5.62203053],[5.94271233, 5.62189021],[5.94691233, 5.62174988],[5.95111233, 5.62160956],[5.95531233, 5.62146924],[5.95951233, 5.62132892],[5.96371233, 5.6211886 ],[5.96791233, 5.62104827],[5.97211233, 5.62090795],[5.97631233, 5.62076763],[5.98051233, 5.62062731],[5.98471233, 5.62048699],[5.98891233, 5.62034667],[5.99311233, 5.62020634],[5.99731233, 5.62006602],[6.00151233, 5.6199257 ],[6.00571233, 5.61978538],[6.00991233, 5.61964506],[6.01411233, 5.61950473],[6.01831233, 5.61936441],[6.02251233, 5.61922409],[6.02671233, 5.61908377],[6.03091233, 5.61894345],[6.03511233, 5.61880313],[6.03931233, 5.6186628 ],[6.04351233, 5.61852248],[6.04771233, 5.61838216],[6.05191233, 5.61824184],[6.05611233, 5.61810152],[6.06031233, 5.61796119],[6.06451233, 5.61782087],[6.06871233, 5.61768055],[6.07291233, 5.61754023],[6.07711233, 5.61739991],[6.08131233, 5.61725959],[6.08551233, 5.61711926],[6.08971233, 5.61697894],[6.09391233, 5.61683862],[6.09811233, 5.6166983 ],[6.10231233, 5.61655798],[6.10651233, 5.61641765],[6.11071233, 5.61627733],[6.11491233, 5.61613701],[6.11911233, 5.61599669],[6.12331233, 5.61585637],[6.12751233, 5.61571604],[6.13171233, 5.61557572],[6.13591233, 5.6154354 ],[6.14011233, 5.61529508],[6.14431233, 5.61515476],[6.14851233, 5.61501444],[6.15271233, 5.61487411],[6.15691233, 5.61473379],[6.16111233, 5.61459347],[6.16531233, 5.61445315],[6.16951233, 5.61431283],[6.17371233, 5.6141725 ],[6.17791233, 5.61403218],[6.18211233, 5.61389186],[6.18631233, 5.61375154],[6.19051233, 5.61361122],[6.19471233, 5.6134709 ],[6.19891233, 5.61333057],[6.20311233, 5.61319025],[6.20731233, 5.61304993],[6.21151233, 5.61290961],[6.21571233, 5.61276929],[6.21991233, 5.61262896],[6.22411233, 5.61248864],[6.22831233, 5.61234832],[6.23251233, 5.612208  ],[6.23671233, 5.61206768],[6.24091233, 5.61192736],[6.24511233, 5.61178703],[6.24931233, 5.61164671],[6.25351233, 5.61150639],[6.25771233, 5.61136607],[6.26191233, 5.61122575],[6.26611233, 5.61108542],[6.27031233, 5.6109451 ],[6.27451233, 5.61080478],[6.27871233, 5.61066446],[6.28291233, 5.61052414],[6.28711233, 5.61038382],[6.29131233, 5.61024349],[6.29551233, 5.61010317],[6.29971233, 5.60996285],[6.30391233, 5.60982253],[6.30811233, 5.60968221],[6.31231233, 5.60954188],[6.31651233, 5.60940156],[6.32071233, 5.60926124],[6.32491233, 5.60912092],[6.32911233, 5.6089806 ],[6.33331233, 5.60884028],[6.33751233, 5.60869995],[6.34171233, 5.60855963],[6.34591233, 5.60841931],[6.35011233, 5.60827899],[6.35431233, 5.60813867],[6.35851233, 5.60799834],[6.36271233, 5.60785802],[6.36691233, 5.6077177 ],[6.37111233, 5.60757738],[6.37531233, 5.60743706],[6.37951233, 5.60729674],[6.38371233, 5.60715641],[6.38791233, 5.60701609],[6.39211233, 5.60687577],[6.39631233, 5.60673545],[6.40051233, 5.60659513],[6.40471233, 5.6064548 ],[6.40891233, 5.60631448],[6.41311233, 5.60617416],[6.41731233, 5.60603384],[6.42151233, 5.60589352],[6.42571233, 5.6057532 ],[6.42991233, 5.60561287],[6.43411233, 5.60547255],[6.43831233, 5.60533223],[6.44251233, 5.60519191],[6.44671233, 5.60505159],[6.45091233, 5.60491126],[6.45511233, 5.60477094],[6.45931233, 5.60463062],[6.46351233, 5.6044903 ],[6.46771233, 5.60434998],[6.47191233, 5.60420965],[6.47611233, 5.60406933],[6.48031233, 5.60392901],[6.48451233, 5.60378869],[6.48871233, 5.60364837],[6.49291233, 5.60350805],[6.49711233, 5.60336772],[6.50131233, 5.6032274 ],[6.50551233, 5.60308708],[6.50971233, 5.60294676],[6.51391233, 5.60280644],[6.51811233, 5.60266611],[6.52231233, 5.60252579],[6.52651233, 5.60238547],[6.53071233, 5.60224515],[6.53491233, 5.60210483],[6.53911233, 5.60196451],[6.54331233, 5.60182418],[6.54751233, 5.60168386],[6.55171233, 5.60154354],[6.55591233, 5.60140322],[6.56011233, 5.6012629 ],[6.56431233, 5.60112257],[6.56851233, 5.60098225],[6.57271233, 5.60084193],[6.57691233, 5.60070161],[6.58111233, 5.60056129],[6.58531233, 5.60042097],[6.58951233, 5.60028064],[6.59371233, 5.60014032],[6.59791233, 5.6       ]])
p.resetJointState(boxId, 0, p1[0][0])
p.resetJointState(boxId, 2, p1[0][1])
p.resetJointState(boxId, 3, 0.2)
p.resetJointState(boxId, 5, 0.1)

x_plot, y_plot = [], []
# pos1 = np.linspace([0, 0, 5], [0, 3, 5], 100)
# pos2 = np.linspace([0, 2.999, 5],[5, 2, 5], 100)
# pos3 = np.linspace([5, 2, 5],[5, 2.999, 5], 100)
# pos = np.concatenate((pos1, pos2))
# path = np.concatenate((pos, pos3))
# p.setTimeStep(0.02)
print('lenth', len(path))
print('path', path)
force = []
print(p.getJointState(boxId,3))
print('get joint info')
print(p.getJointInfo(boxId,3))
print(p.getJointInfo(boxId,5))
print(p.getLinkState(boxId,6))
print(p.getLinkState(boxId,6)[0][0], p.getLinkState(boxId,6)[0][2])
# for i in range(100):
angle = []
f_plot = []
print("joint dynamics", p.getDynamicsInfo(boxId,3))
for i in range(len(p1)):
    p.stepSimulation()
    p.setGravity(0, 0, -10.0)
    p.setJointMotorControl2(
        boxId,
        0,
        p.POSITION_CONTROL,
        p1[:, 0][i],
        target_v,
        max_force
    )
    p.setJointMotorControl2(
        boxId,
        2,
        p.POSITION_CONTROL,
        p1[:, 1][i],
        target_v,
        max_force
    )
    p.setJointMotorControl2(
        boxId,
        3,
        p.POSITION_CONTROL,
        targetPosition=0.2, targetVelocity=0,
        positionGain=0.1, velocityGain=0.9, force=20)
    p.setJointMotorControl2(
        boxId,
        5,
        p.POSITION_CONTROL,
        targetPosition=0.4, targetVelocity=0,
        positionGain=0.4, velocityGain=0.9, force=50)

    # x = p.getJointState(boxId, 0)[0]
    # y = p.getJointState(boxId, 2)[0]
    # f = p.getJointState(boxId, 4)[0]
    # if abs(x - 3) < 0.1 and (y - 3) < 0.1:
    #     print('loop end', 'x =', x, y)
    #     break
    # p.setJointMotorControl2(
    #     boxId,
    #     0,
    #     p.POSITION_CONTROL,
    #     # np.sin(i/50),
    #     0,
    #     target_v,
    #     max_force
    # )
    # p.setJointMotorControl2(
    #     boxId,
    #     1,
    #     p.POSITION_CONTROL,
    #     0,
    #     # p1[i][1],
    #     target_v,
    #     max_force
    # )
    # f = -10.0*(p.getJointState(boxId,3)[0]-(0.2))
    # - p.getJointState(boxId,3)[3]
    # p.setJointMotorControl2(
    #     boxId,
    #     3,
    #     p.TORQUE_CONTROL,
    #     force = f
    #     # 500.0
    # )
    # p.setJointMotorControl2(
    #     boxId,
    #     3,
    #     p.VELOCITY_CONTROL,
    #     # force = 100)
    #     # force = -50*(p.getJointState(boxId,3)[0]%(2*np.pi)-(0.5)))
    #     force=f)
    # p.setJointMotorControl2(
    #     boxId,
    #     3,
    #     p.POSITION_CONTROL,
    #     targetPosition=0.2, targetVelocity=0,
    #     positionGain=0.1, velocityGain=0.9, force=20)
    # p.setJointMotorControl2(
    #     boxId,
    #     5,
    #     p.POSITION_CONTROL,
    #     targetPosition=0.2, targetVelocity=0,
    #     positionGain=0.1, velocityGain=0.9, force=10)
    # print('angular displacement and force',p.getJointState(boxId,3)[0], p.getJointState(boxId,3), f)
    # time.sleep(0.002)
    # x_plot.append(x)
    # y_plot.append(y)
    # angle.append(p.getJointState(boxId,3)[0])
    # f_plot.append(f)
    # print(p.getLinkState(boxId, 6))
    time.sleep(0.0001)
    x = p.getJointState(boxId, 0)[0]
    y = p.getJointState(boxId, 2)[0]
    theta = p.getJointState(boxId, 3)[0]
    theta_2 = p.getJointState(boxId, 5)[0]
    f_1 = p.getJointState(boxId, 4)[2]
    # print('join force', f_1)
    f = p.getJointState(boxId, 4)[0]
    x_plot.append(x)
    y_plot.append(y)
    force.append(f)
    joint1_pos.append(f_1)

#     force

# while p.isConnected():
#     p.stepSimulation()
#     p.setGravity(0, 0, -10)
#     p.setJointMotorControl2(
#         boxId,
#         0,
#         p.VELOCITY_CONTROL,
#         force = 0)
#     p.setJointMotorControl2(
#         boxId,
#         2,
#         p.VELOCITY_CONTROL,
#         force = 100)
#
#     p.setJointMotorControl2(
#         boxId,
#         3,
#         p.VELOCITY_CONTROL,
#         force=-50*(p.getJointState(boxId,3)[0]%(2*np.pi)-(0.5))
#     )
#     print('force', -50*(p.getJointState(boxId,3)[0]%(2*np.pi)-(0.5)) )
#     print('angular displacement and force',p.getJointState(boxId,3)[0], p.getJointState(boxId,3)[0]%(2*np.pi), p.getJointState(boxId,3)[3])
end_pos = [p.getLinkState(boxId,6)[0][0], p.getLinkState(boxId,6)[0][2]]
ax = plt.subplot(1, 1, 1)
ax.set_aspect(1)
ax.set_xlim(0, 10)
ax.set_ylim(0, 10)
plt.plot(
    [5, 5,
     10,
     10, 5],
    [0, 5,
     5,
     0, 0], color='r')  # 画处障碍物区域

# time.sleep(0.5)
# print('xy from simulation', x_plot,
#       '\ny', y_plot)
# print("simulation result", p.getJointState(boxId, 0), p.getJointState(boxId, 2))
# print("joint dynamics", p.getDynamicsInfo(boxId,3))
# g = 10
# torque_grav = 2.5*g*np.sin(p.getJointState(boxId,3)[0])*1.0/2 + 0.2*g*np.sin(p.getJointState(boxId,3)[0])*1.0
# print('torque_grav', torque_grav)
# ax = plt.subplot(2, 1, 1)
# ax.set_aspect(1)
# ax.set_xlim(0, 10)
# ax.set_ylim(0, 10)
# plt.plot(
#     [5, 5,
#      10,
#      10, 5],
#     [0, 5,
#      5,
#      0, 0], color='r')  # draw the obstacle area
# ax.plot(x_plot, y_plot, color='purple')
# damp = []
# for i in range(1000):
#     exp = 0.7 * np.exp(-0.05*i/(2*2.7))  ### this probably should be the angular moment of inertia, rather than mass
#     damp.append(exp)
# ax.plot(damp)
# ax.plot(angle)
#
# ax = plt.subplot(2, 1, 2)
#
# ax.plot(f_plot)
plt.show()
p.resetSimulation()